<!DOCTYPE html><html lang="en-lang"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>【Hadoop学习】YARN学习 · dxer</title><meta name="description" content="【Hadoop学习】YARN学习 - dxer"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.ico"><link rel="stylesheet" href="/css/style.css"><!-- fonts--><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" href="http://fonts.lug.ustc.edu.cn/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><input type="checkbox" id="sidebar-toggle"><aside><div class="author"><a href="/."><img src="/img/author.png" class="author-img"></a><h2 class="author-name">dxer</h2></div><div class="post-toc"><span class="toc-title">Directory</span><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ResourceManager"><span class="toc-text">ResourceManager</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ApplicationMaster"><span class="toc-text">ApplicationMaster</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NodeManager"><span class="toc-text">NodeManager</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Container"><span class="toc-text">Container</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#YARN工作流程"><span class="toc-text">YARN工作流程</span></a></li></ol></div></aside><div class="main"><header><div id="top"><a href="/." class="logo-link">dxer</a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">Archive</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">Tags</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">About</a></li></ul></div></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">【Hadoop学习】YARN学习</h1><div class="post-time">Nov 3, 2015</div><div class="post-content"><p>YARN采用Master/Slave架构，ResourceManager为Master，NodeManager为Slave。ResourceManager负责对各个NodeManager上的资源进行统一管理和调度，当用户提交一个应用程序时，需要提供一个用来跟踪和管理这个程序的ApplicationMaster，它负责向ResourceManager申请资源，并要求NodeManager启动可以占用一定资源的任务。由于不同的ApplicationMaster被分布到不同的节点上，因此它们之间不会相互影响。<br><a id="more"></a></p>
<h2 id="ResourceManager"><a href="#ResourceManager" class="headerlink" title="ResourceManager"></a>ResourceManager</h2><p>ResourceManager简称RM，是一个全局的资源管理器，负责整个系统的资源管理和分配工作。主要由调度器（Scheduler）和应用程序管理器（Applications Master，ASM）两部分组成。</p>
<ol>
<li>调度器（Scheduler）<br>调度器根据容量，队列等限制条件将系统中的资源分配给各个正在运行的应用程序。</li>
<li>应用程序管理器（Applications Master）<br>ApplicationMaster负责管理整个系统中所有应用程序，包括应用程序提交、与调度器协商资源以启动ApplicationMaster，监控ApplicationMaster运行状态并在失败时重新启动它等。</li>
</ol>
<h2 id="ApplicationMaster"><a href="#ApplicationMaster" class="headerlink" title="ApplicationMaster"></a>ApplicationMaster</h2><p>ApplicationMaster简称AM。YARN中每个应用都会启动一个AM。<br>主要功能包括：</p>
<ol>
<li>与RM调度器协商以获取资源</li>
<li>将得到的任务进一步分配给内部的任务</li>
<li>与NM通信以启动/停止任务</li>
<li>监控所有任务运行状态，并在任务失败时重新为任务申请资源以重新运行任务</li>
</ol>
<h2 id="NodeManager"><a href="#NodeManager" class="headerlink" title="NodeManager"></a>NodeManager</h2><p>NodeManager简称NM，NM是每个节点上的资源和任务管理器<br>主要功能包括：</p>
<ol>
<li>定时向RM汇报本节点上的资源使用情况和各个Continer的运行状态</li>
<li>接收并处理来自AM的Container启动/停止等各种请求</li>
</ol>
<h2 id="Container"><a href="#Container" class="headerlink" title="Container"></a>Container</h2><p>Container是YARN中资源容器。它封装了某个节点上的多维度资源，如内存、cpu、磁盘、网络等。YARN中所有的应用都是在container上运行的。AM也是在container上运行的，不过AM的container是向RM申请的。YARN会为每一个任务分配一个Container，并且该任务只能使用该Container中描述的资源。</p>
<h2 id="YARN工作流程"><a href="#YARN工作流程" class="headerlink" title="YARN工作流程"></a>YARN工作流程</h2><p>YARN上运行的应用程序主要分为两类：短应用程序和长应用程序。</p>
<ul>
<li>短应用程序是指一定时间内（可能是秒级、分钟级或小时级，尽管天级别或者更长时间的也存在，但是非常少）可运行完成并征程退出的应用程序</li>
<li>长应用程序是指不出意外，永不终止运行的应用程序，通常是一些服务，如Storm，HBase等</li>
</ul>
<p>YARN的工作流程包括：</p>
<ol>
<li>向YARN中提交一个应用程序，其中包括ApplicationMaster程序，启动ApplicationMaster的命令，用户程序等</li>
<li>ResourceManager为该应用程序分配一个Container，并与对应的NodeManager通信，要求它在这个Container中启动应用程序的ApplicationMaster</li>
<li>ApplicationMaster首先向ResourceManager注册（注册之后可以直接通过ResourceManager查看应用程序的运行状态），然后它将为各个任务申请资源，并监控它的运行状态，直到运行结束</li>
<li>ApplicationMaster采用轮询的方式通过RPC协议向ResourceManager申请和领取资源</li>
<li>一旦ApplicationMaster申请到资源后，便与对应的NodeManager通信，要求它启动任务</li>
<li>NodeManager为任务设置好运行环境（包括环境变量，jar包，二进制程序等）后，将任务启动命令写到一个脚本中，并通过运行该脚本启动任务</li>
<li>各个任务通过RPC协议向ApplicationMaster汇报自己的状态和进度，使得ApplicationMaster随时掌握各个任务的运行状态，从而可以在任务失败时重新启动任务</li>
</ol>
</div></article></div><div class="tags"><a href="/tags/hadoop/">hadoop</a><a href="/tags/bigdata/">bigdata</a><a href="/tags/YAR/">YAR</a></div><div class="paginator"><a href="/2015/12/02/neo4j-01/" class="prev"><i class="fa fa-chevron-left"></i><span> Prev</span></a><a href="/2015/11/03/hadoop_ha/" class="next"><span>Next</span><i class="fa fa-chevron-right"></i></a></div></section><footer><section id="comments"><div data-thread-key="http://dxer.github.io/2015/11/03/yarn/index.html" data-title="【Hadoop学习】YARN学习" data-url="http://dxer.github.io/2015/11/03/yarn/index.html" class="ds-thread"></div><script type="text/javascript">var duoshuoQuery = {short_name: "smarthader" };
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></section><div class="copyright"><p>© 2016<span class="heart"><i class="icon-next-heart fa fa-heart"></i></span><a href="http://dxer.github.io">dxer</a></p></div><div style="display:none"><script src="http://s11.cnzz.com/z_stat.php?id=1254885963&web_id=1254885963" language="JavaScript"></script></div></footer></div><label class="back2top"> <a href="#top"><i class="fa fa-chevron-up"></i></a></label></body></html>